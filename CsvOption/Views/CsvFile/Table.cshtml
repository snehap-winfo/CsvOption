@model List<CsvOption.Models.CsvRow>
@{
    ViewData["Title"] = "Table";
    var fileName = ViewBag.FileName as string;
}

<h1 align="center">Table</h1>

<div>
    <a asp-action="DownloadAsPdf" asp-route-fileName="@ViewBag.FileName" class="btn btn-outline-info ">
        Download PDF
    </a>

    <a asp-action="DownloadAsExcel" asp-route-fileName="@ViewBag.FileName" class="btn btn-outline-info">
        Download Excel
    </a>
</div>
<br/>

@if (Model?.Count > 0)
{
    <div style="display: flex; align-items: flex-start;">
    <table align="center" border="1" class="table">
        <thead>
            @foreach (var header in Model.First().Fields.Keys)
            {
                <th>@header</th>
            }
            <th>Actions</th>
       
        </thead>

        <tbody>
            @for (int i = 0; i < Model.Count; i++)
            {
                <tr>
                    @foreach (var value in Model[i].Fields.Values)
                    {
                        <td>@value</td>
                    }
                    <td>
                        <a asp-action="Edit"
                           asp-route-fileName="@ViewBag.FileName"
                           asp-route-id="@i">
                            Edit
                        </a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
    <div style="text-align:center; margin-bottom:15px;">
        <a asp-action="AddColumn" asp-route-fileName="@fileName" class="btn btn-success">Add Column</a>
    </div>
    </div>
}
